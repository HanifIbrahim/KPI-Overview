<!DOCTYPE html>
<html lang="en">
<head>
  <script>
function showSection(sectionId) {
    // Hide all sections
    document.querySelectorAll('.content section').forEach(function (sec) {
        sec.style.display = 'none';
    });
    // Show the selected section
    document.getElementById(sectionId).style.display = 'block';
}
</script>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        .header {
            background: #333;
            color: #fff;
            padding: 10px;
            text-align: center;
        }
        .container {
            display: flex;
        }
        .sidebar {
            width: 200px;
            background: #f0f0f0;
            padding: 20px;
            box-sizing: border-box;
        }
        .content {
            flex-grow: 1;
            padding: 20px;
            box-sizing: border-box;
        }
    </style>
  <script>
function showSection(sectionId) {
    // Hide all sections
    document.querySelectorAll('.content section').forEach(function (sec) {
        sec.style.display = 'none';
    });
    // Show the selected section
    document.getElementById(sectionId).style.display = 'block';
}
</script>
</head>
<body>
<ul>
  <li><a href="#!" onclick="showSection('units-prod')">Data (Units/Prod)</a></li>
  <li><a href="#!" onclick="showSection('weekly-by-dept')">Data (Weekly by Dept)</a></li>
  <li><a href="#!" onclick="showSection('kpi-forecasting')">KPI Forecasting</a></li>
</ul>

<div class="content">
    <!-- Units/Prod section -->
    <section id="units-prod">
        <h2>Units/Prod</h2>
        <!-- Replace the placeholder paragraph with your Google Sheets iframe -->
        <iframe
           src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSxo6dLzN23KhiDNUEKL76_nzALDs9utPshKMLszuxGqED1QjUMAt6A0yLse0inI5LsSVfCBO_cegvt/pubhtml?gid=219996180&amp;single=true&amp;widget=true&amp;headers=false"
           width="100%"
           height="450"
           frameborder="0"
        ></iframe>
    </section>
      <div id="units-insights">
  <h3>Units/Prod Insights</h3>
  <ul id="units-summary"></ul>
  <canvas id="unitsChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const sheetId = 'YOUR_SHEET_ID';
const apiKey  = 'YOUR_API_KEY';
const range   = 'UnitsData!A2:B';  // adjust for your sheet: labels in col A, values in col B
const url     = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${encodeURIComponent(range)}?key=${apiKey}`;

fetch(url).then(resp => resp.json()).then(data => {
  const rows = data.values || [];
  const labels = [];
  const units  = [];
  rows.forEach(row => {
    labels.push(row[0]);
    units.push(Number(row[1]));
  });

  // Compute metrics:contentReference[oaicite:4]{index=4}.
  const total   = units.reduce((acc, v) => acc + v, 0);
  const average = units.length ? total / units.length : 0;

  // Show metrics in the summary list.
  const summary = document.getElementById('units-summary');
  summary.innerHTML = `<li><strong>Total units:</strong> ${total}</li>
                       <li><strong>Average per entry:</strong> ${average.toFixed(2)}</li>`;

  // Draw bar chart:contentReference[oaicite:5]{index=5}.
  new Chart(document.getElementById('unitsChart').getContext('2d'), {
    type: 'bar',
    data: { labels: labels, datasets: [{ label: 'Units', data: units, backgroundColor: 'rgba(54,162,235,0.6)' }] },
    options: { scales: { y: { beginAtZero: true } } }
  });
}).catch(err => console.error(err));
</script>
    <!-- Weekly by Dept section -->
    <section id="weekly-by-dept" style="display:none;">
        <h2>Weekly by Dept</h2>
        <iframe
           src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSxo6dLzN23KhiDNUEKL76_nzALDs9utPshKMLszuxGqED1QjUMAt6A0yLse0inI5LsSVfCBO_cegvt/pubhtml?gid=1278216070&amp;single=true&amp;widget=true&amp;headers=false"
           width="100%"
           height="450"
           frameborder="0"
        ></iframe>
    </section>

    <!-- KPI Forecasting section -->
    <section id="kpi-forecasting" style="display:none;">
        <h2>KPI Forecasting</h2>
        <iframe
           src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSxo6dLzN23KhiDNUEKL76_nzALDs9utPshKMLszuxGqED1QjUMAt6A0yLse0inI5LsSVfCBO_cegvt/pubhtml?gid=1150923660&amp;single=true&amp;widget=true&amp;headers=false"
           width="100%"
           height="450"
           frameborder="0"
        ></iframe>
    </section>
</div>

</body>
</html>
